%ul.list-inline.bg-info.label_bg
  %li
    %label.label{class: 'label-success' }
      = link_to "全部", dashboard_entities_path
  - Category.all.each do |category|
    %li
      %label.label{class: cycle('label-warning', 'label-success', 'label-default') } 
        = link_to category.name, dashboard_entities_path(category_id: category.id)

%ul.list-inline.bg-info.label_bg
  %li
    %label.label{class: 'label-success' }
      = link_to "全部", dashboard_entities_path
  - Tag.all.each do |tag|
    %li
      %label.label{class: cycle('label-warning', 'label-success', 'label-default') } 
        = link_to tag.name, dashboard_entities_path(tag_id: tag.id)


= link_to gly_icon(:plus) + "上传模型", new_dashboard_entity_path, class: 'btn btn-primary pull-right'

.row
%hr

%table.table
  %thead
    %th ID
    %th 文件夹
    %th 模型名
    %th 上传时间
    %th 是否可见
    %th
  %tbody
    - @entities.each do |v|
      %tr
        %td= link_to v.id, edit_dashboard_entity_path(v)
        %td= link_to v.category.try(:name), dashboard_entities_path(category_id: v.category_id)
        %td= v.name
        %td= v.created_at.to_s(:cn_short_normal)
        %td
          = check_box_tag "visible", v.visible, v.visible, class: 'toggle_visible', data: { entity_id: v.id }
        %td
          = link_to "修改", edit_dashboard_entity_path(v)
          = link_to "删除", dashboard_entity_path(v), method: :delete, data: { confirm: "删除此模型？" }, class: 'btn btn-warning btn-default'

= paginate @entities


:javascript
  $(document).ready(function() { $('.toggle_visible').change(
    function(){
      $.ajax({
        url: "/dashboard/entities/" + $(this).data('entity-id') + "/toggle_visible",
        method: 'PATCH'
      })
    }
  );});
